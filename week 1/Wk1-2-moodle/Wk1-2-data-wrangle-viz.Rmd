---
title: "Week 1-1 Data manipulation and visualisation"
output: html_document
#   moodlequiz::moodlequiz:
#     replicates: 1
# moodlequiz:
#   category: "Week 1-2 data wrangle + viz"
# editor_options: 
#   chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# remotes::install_github("numbats/moodlequiz")
library(moodlequiz)
```

# Data wrangling + visualisation

<h3>Data wrangling + visualisation</h3>

Wrangling your data into the right format is a critical step to data visualisation and analysis. It is a scientist's bread and butter. Today, we will be working primarily with the packages `dplyr` and `ggplot2` and to apply the skills you've learned so far to make some publication-ready plots - let's get started!

![Artwork by @allison_horst](nice-R.png){width=70%}
<br>

<h4>Setting up</h4>

**Materials:**

Everything you need for this prac is on Moodle

1. Download the `Wk1-2-materials` zip file from Moodle, from the course page
2. Extract the zip file into your `BEES2041/` folder
3. Unzip the file by: 
  - MacOS: Double clicking the file `Wk-1-intro`
  - Windows: Right click on the zip file and click "Extract All" 
5. **Click on the `Wk-1-2-data-manip.Rproj`** to open the RStudio project and you're in!!!

We will be working with real-world datasets collected by researched in the School of Biological, Earth & Environmental Sciences. These are in the `data/`.

Each dataset is associated with its own Quarto document (`Wk1-2-plant-height.qmd`, `Wk1-2-stalagmites.qmd`). Within each Quarto docs there are several challenges for you to complete on your own devices in order to **answer the questions on Moodle**.

Before we dive in, let's consider what data visualisation means.

### Thinking about data visualisations

A picture is worth a thousands words. The choice of your visualisation can have a huge impact on the key message you want to give to the viewer - consider: **What is it that I want to convey?**

> Remember the `palmerpengiuns`? They will also be joining us in this prac.


```{r}
# install.packges(c("ggplot2", "palmerpenguins"))

library(ggplot2)
library(palmerpenguins)

penguins
```

**Activity**: 

For each question below, work with your fellow classmates to determine a suitable data viz. Think about:

- what are the key variables of interest and their respective variable type,
- how to best represent that data using graphics 

Get creative, feel free to put the white boards/pen and paper to good use!

> You can also use this [data-to-viz website](https://www.data-to-viz.com/) to explore and get inspired

**Question: What type of plot would be suitable to answer the following questions (Select all that apply):**

1. What is the distribution of bill depth of each penguin species? `r`
2. How does bill length vary between islands?  (Select all that apply) `r`
3. Which penguin species have the shortest flippers? `r`
4. What is the relationship between bill length and depth in different species? `r`
5. Does the relationship between bill length and depth change over time? `r`

> Now, let's properly introduce `ggplot2` to you.

## ggplot2 

`ggplot2` is package for creating graphics, based on [The Grammar of Graphics](https://www.amazon.com/Grammar-Graphics-Statistics-Computing/dp/0387245448/ref=as_li_ss_tl). You provide the data, speak to `ggplot2` about how to map variables to **aesthetics**, what **geometries** to you, and it takes care of the details.

![Have you met `ggplot2`?](ggplot2-hex.png){width=20%}

### The recipe for a `ggplot()`

There are four core components to a `ggplot` :

1. The **data** you are working with e.g `penguins`
2. The **aesthetics** which controls which variables you want to work with
3. The **geometries** dictates the type of plot you want to create
3. The **theme** where you can fine tune the "look" of your plot

![Image credit: Fonti Kar](ggplot2-basic-recipe.png)

**Notice** instead of pipes `|>`, we use `+` to add layers of components to a plot. 

Throughout the course, you'll learn to tweak these four components to create beautiful data vizzes. 

> Let's try tackle the first question together

**1. What is the distribution of bill depth of each penguin species?**

From the question, we know we want to be working with `species` and `bill_depth_mm`, these will be our **aesthetics**. 

- `species` is the `group` variable we want to detect differences, making it an "independent" or **"predictor"** variable. 
- `bill_depth_mm` is the entity we want to use compare, making it a "dependent" or **"response"** variable. 

> I've decided that a histogram would be a good choice to very the distribution of `bill_depth_mm` and looking at the shapes of histograms for the three species will help me answer the question.

Histograms depict the range of values along the `x` axis and the height of the bars represent the `count` of each value. 

Here's the code to create a histogram for each species: 

```{r}
ggplot(data = penguins, # my data 
       aes(x = bill_depth_mm, # what I want to depict on the x axis `bill_depth_mm`
           group = species,  # what I want to compare between species
           colour = species, # I want to colour my histograms by `species`
           fill = species)) + # I want to fill the bars of my histogram by `species`
         geom_histogram() +  # my choice of geometry
         theme_minimal() # my choice of theme styling
```

Let's talk through this code:

## Now, your turn!

Using the `ggplot-intro.qmd` document, use `ggplot2` to make the remaining plots from about.

> Reposting the questions here again so you don't have to scroll back and forth

**Question: What type of plot would be suitable to answer the following questions:**

1. What is the distribution of bill depth of each penguin species? [DONE]
2. How does bill length vary between islands?  
3. Which penguin species have the shortest flippers? 
4. What is the relationship between bill length and depth in different species? 
5. Does the relationship between bill length and depth change over time? 

> Check out the [`ggplot2` cheatsheet](https://posit.co/wp-content/uploads/2022/10/data-visualization-1.pdf) to see the variety of **geometries** and options at your disposal

![Save the cheatsheet on your computer if you find it helpful, Image credit: Posit PBC](ggplot2-cheatsheet.png)

<br>

Depending on the plot or `geom_` you of your choice, I like to think **aesthetics** as: 
- `x` as the variable in which I want to test if there is an effect. e.g. `year`, `species`, `island`
- `y` as the variable where I want to detect an effect. e.g `bill_depth_mm`, `body_mass_g`

## Bring on the real-world datasets!

Over to you, open either the `plant

